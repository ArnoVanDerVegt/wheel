/**
 * Wheel, copyright (c) 2019 - present by Arno van der Vegt
 * Distributed under an MIT license: https://arnovandervegt.github.io/wheel/license.txt
**/
(function() {
    const files = [
            './js/browser/routes/ide',
            './js/shared/vm/modules/buttonModuleConstants',
            './js/shared/vm/modules/fileModuleConstants',
            './js/shared/vm/modules/lightModuleConstants',
            './js/shared/vm/modules/mathModuleConstants',
            './js/shared/vm/modules/motorModuleConstants',
            './js/shared/vm/modules/screenModuleConstants',
            './js/shared/vm/modules/sensorModuleConstants',
            './js/shared/vm/modules/soundModuleConstants',
            './js/shared/vm/modules/standardModuleConstants',
            './js/shared/vm/modules/systemModuleConstants',
            './js/shared/vm/modules/stringModuleConstants',
            './js/shared/lib/RgfImage',
            './js/frontend/lib/utils',
            './js/frontend/lib/dispatcher',
            './js/frontend/lib/Emitter',
            './js/frontend/lib/path',
            './js/frontend/lib/dom',
            './js/frontend/lib/Http',
            './js/frontend/lib/dataprovider/HttpDataProvider',
            './js/frontend/lib/dataprovider/dataProvider',
            './js/frontend/program/commands',
            './js/frontend/program/Program',
            './js/frontend/program/output/Rtf',
            './js/frontend/program/output/Text',
            './js/frontend/compiler/errors',
            './js/frontend/compiler/tokenizer/tokenizer',
            './js/frontend/compiler/tokenizer/tokenUtils',
            './js/frontend/compiler/tokenizer/TokenIterator',
            './js/frontend/compiler/syntax/utils',
            './js/frontend/compiler/syntax/syntaxRoot',
            './js/frontend/compiler/syntax/syntaxProc',
            './js/frontend/compiler/syntax/syntaxProcName',
            './js/frontend/compiler/syntax/syntaxProcParams',
            './js/frontend/compiler/syntax/syntaxRecord',
            './js/frontend/compiler/syntax/syntaxAddr',
            './js/frontend/compiler/syntax/syntaxModule',
            './js/frontend/compiler/syntax/syntaxBreak',
            './js/frontend/compiler/syntax/syntaxSelect',
            './js/frontend/compiler/syntax/syntaxSelectValue',
            './js/frontend/compiler/syntax/syntaxSelectCaseValue',
            './js/frontend/compiler/syntax/syntaxSelectDefault',
            './js/frontend/compiler/syntax/syntaxForTo',
            './js/frontend/compiler/syntax/syntaxForToAssignment',
            './js/frontend/compiler/syntax/syntaxNumericAssignment',
            './js/frontend/compiler/syntax/syntaxBoolean',
            './js/frontend/compiler/syntax/syntaxAssignment',
            './js/frontend/compiler/syntax/syntaxBlock',
            './js/frontend/compiler/syntax/SyntaxValidator',
            './js/frontend/compiler/types/Var',
            './js/frontend/compiler/types/Scope',
            './js/frontend/compiler/types/Record',
            './js/frontend/compiler/types/Proc',
            './js/frontend/compiler/compiler/CompileData',
            './js/frontend/compiler/expression/mathExpression',
            './js/frontend/compiler/expression/varExpression',
            './js/frontend/compiler/expression/expression',
            './js/frontend/compiler/expression/booleanExpression',
            './js/frontend/compiler/compiler/CompileScope',
            './js/frontend/compiler/compiler/CompileCall',
            './js/frontend/compiler/compiler/CompileVars',
            './js/frontend/compiler/compiler/CompileBlock',
            './js/frontend/compiler/compiler/CompileLoop',
            './js/frontend/compiler/linter/Linter',
            './js/frontend/compiler/resources/ProjectResource',
            './js/frontend/compiler/resources/ImageResource',
            './js/frontend/compiler/resources/TextResource',
            './js/frontend/compiler/resources/ProjectResources',
            './js/frontend/compiler/preprocessor/Defines',
            './js/frontend/compiler/preprocessor/MetaCompiler',
            './js/frontend/compiler/preprocessor/PreProcessor',
            './js/frontend/compiler/keyword/CompileAddr',
            './js/frontend/compiler/keyword/CompileBreak',
            './js/frontend/compiler/keyword/CompileFor',
            './js/frontend/compiler/keyword/CompileIf',
            './js/frontend/compiler/keyword/CompileModule',
            './js/frontend/compiler/keyword/CompileProc',
            './js/frontend/compiler/keyword/CompileRecord',
            './js/frontend/compiler/keyword/CompileRepeat',
            './js/frontend/compiler/keyword/CompileRet',
            './js/frontend/compiler/keyword/CompileSelect',
            './js/frontend/compiler/keyword/CompileWhile',
            './js/frontend/compiler/Compiler',
            './js/frontend/vm/modules/local/VMModule',
            './js/frontend/vm/modules/local/ButtonModule',
            './js/frontend/vm/modules/local/FileModule',
            './js/frontend/vm/modules/local/LightModule',
            './js/frontend/vm/modules/local/MathModule',
            './js/frontend/vm/modules/local/MotorModule',
            './js/frontend/vm/modules/local/ScreenModule',
            './js/frontend/vm/modules/local/SensorModule',
            './js/frontend/vm/modules/local/SoundModule',
            './js/frontend/vm/modules/local/StandardModule',
            './js/frontend/vm/modules/local/SystemModule',
            './js/frontend/vm/modules/local/StringModule',
            './js/frontend/vm/brick/LayerState',
            './js/frontend/vm/modules/remote/VMModule',
            './js/frontend/vm/modules/remote/ButtonModule',
            './js/frontend/vm/modules/remote/FileModule',
            './js/frontend/vm/modules/remote/LightModule',
            './js/frontend/vm/modules/remote/MathModule',
            './js/frontend/vm/modules/remote/MotorModule',
            './js/frontend/vm/modules/remote/ScreenModule',
            './js/frontend/vm/modules/remote/SensorModule',
            './js/frontend/vm/modules/remote/SoundModule',
            './js/frontend/vm/modules/remote/StandardModule',
            './js/frontend/vm/modules/remote/SystemModule',
            './js/frontend/vm/modules/remote/StringModule',
            './js/frontend/vm/VMData',
            './js/frontend/vm/VM',
            './js/frontend/lib/components/Component',
            './js/frontend/lib/components/ContextMenu',
            './js/frontend/lib/components/Tabs',
            './js/frontend/lib/components/Menu',
            './js/frontend/lib/components/MainMenuItem',
            './js/frontend/lib/components/MainMenu',
            './js/frontend/lib/components/Button',
            './js/frontend/lib/components/Resizer',
            './js/frontend/lib/components/CloseButton',
            './js/frontend/lib/components/IconSelect',
            './js/frontend/lib/components/TextInput',
            './js/frontend/lib/components/Checkbox',
            './js/frontend/lib/components/Radio',
            './js/frontend/lib/components/Slider',
            './js/frontend/lib/components/Hint',
            './js/frontend/lib/components/ToolOptions',
            './js/frontend/lib/components/ComponentContainer',
            './js/frontend/lib/components/Toolbar',
            './js/frontend/lib/components/Dialog',
            './js/frontend/lib/components/ProgressBar',
            './js/frontend/lib/components/files/File',
            './js/frontend/lib/components/files/FileDetail',
            './js/frontend/lib/components/files/Files',
            './js/frontend/lib/components/filetree/Item',
            './js/frontend/lib/components/filetree/File',
            './js/frontend/lib/components/filetree/Directory',
            './js/frontend/lib/components/filetree/FileTree',
            './js/frontend/lib/components/tree/TreeNode',
            './js/frontend/lib/components/tree/Tree',
            './js/frontend/lib/components/basic/A',
            './js/frontend/lib/components/basic/H',
            './js/frontend/lib/components/basic/P',
            './js/frontend/lib/components/basic/Pre',
            './js/frontend/lib/components/basic/Table',
            './js/frontend/lib/components/basic/Ul',
            './js/frontend/lib/components/basic/Img',
            './js/frontend/lib/directoryWatcher',
            './js/frontend/lib/fileDropHandler',
            './js/frontend/ide/data/images',
            './js/frontend/ide/data/templates',
            './js/frontend/ide/data/texts',
            './js/frontend/ide/tabIndex',
            './js/frontend/ide/help/components/IndexList',
            './js/frontend/ide/help/woc/FileProcessor',
            './js/frontend/ide/help/woc/SubjectFileProcessor',
            './js/frontend/ide/help/woc/WhlFileProcessor',
            './js/frontend/ide/help/woc/WocFileProcessor',
            './js/frontend/ide/help/woc/Woc',
            './js/frontend/ide/help/woc/WheelSyntax',
            './js/frontend/ide/help/helpData',
            './js/frontend/ide/help/HelpBuilder',
            './js/frontend/ide/dialogs/AlertDialog',
            './js/frontend/ide/dialogs/hint/HintDialog',
            './js/frontend/ide/dialogs/hint/WelcomeHintDialog',
            './js/frontend/ide/dialogs/ConfirmDialog',
            './js/frontend/ide/dialogs/ExploreDialog',
            './js/frontend/ide/dialogs/list/components/ListItem',
            './js/frontend/ide/dialogs/list/ListDialog',
            './js/frontend/ide/dialogs/list/ConnectListDialog',
            './js/frontend/ide/dialogs/YesNoCancelDialog',
            './js/frontend/ide/dialogs/file/components/IncludeFiles',
            './js/frontend/ide/dialogs/file/FileDialog',
            './js/frontend/ide/dialogs/file/FileNewDialog',
            './js/frontend/ide/dialogs/file/FileRenameDialog',
            './js/frontend/ide/dialogs/image/components/ImagePreview',
            './js/frontend/ide/dialogs/image/components/Step',
            './js/frontend/ide/dialogs/image/components/StepSelect',
            './js/frontend/ide/dialogs/image/components/StepScale',
            './js/frontend/ide/dialogs/image/components/StepContrast',
            './js/frontend/ide/dialogs/image/components/StepFilename',
            './js/frontend/ide/dialogs/image/ImageDialog',
            './js/frontend/ide/dialogs/image/ImageNewDialog',
            './js/frontend/ide/dialogs/image/ImageResizeDialog',
            './js/frontend/ide/dialogs/image/ImageLoadDialog',
            './js/frontend/ide/dialogs/VolumeDialog',
            './js/frontend/ide/dialogs/help/components/WocFileLoader',
            './js/frontend/ide/dialogs/help/HelpDialog',
            './js/frontend/ide/dialogs/directcontrol/components/Motor',
            './js/frontend/ide/dialogs/directcontrol/components/Motors',
            './js/frontend/ide/dialogs/directcontrol/components/PianoKey',
            './js/frontend/ide/dialogs/directcontrol/components/Piano',
            './js/frontend/ide/dialogs/directcontrol/DirectControlDialog',
            './js/frontend/ide/dialogs/DaisyChainDialog',
            './js/frontend/ide/dialogs/license/LicenseDialog',
            './js/frontend/ide/dialogs/license/WheelLicenseDialog',
            './js/frontend/ide/dialogs/directory/DirectoryNewDialog',
            './js/frontend/ide/dialogs/ReplaceDialog',
            './js/frontend/ide/dialogs/download/components/ResourceLine',
            './js/frontend/ide/dialogs/download/DownloadDialog',
            './js/frontend/ide/menu/HelpOption',
            './js/frontend/ide/menu/MainMenu',
            './js/frontend/ide/editor/editors/Clipboard',
            './js/frontend/ide/editor/editors/Editor',
            './js/frontend/ide/editor/editors/home/HomeScreenTile',
            './js/frontend/ide/editor/editors/home/HomeScreenConnectTile',
            './js/frontend/ide/editor/editors/home/HomeScreenRecentProjectTile',
            './js/frontend/ide/editor/editors/home/HomeScreen',
            './js/frontend/ide/editor/editors/text/toolbar/ToolbarBottom',
            './js/frontend/ide/editor/editors/text/toolbar/ToolbarBottomViewer',
            './js/frontend/ide/editor/editors/text/VMViewer',
            './js/frontend/ide/editor/editors/text/WheelEditorState',
            './js/frontend/ide/editor/editors/text/WheelEditor',
            './js/frontend/ide/editor/editors/text/TextEditor',
            './js/frontend/ide/editor/editors/image/text/Text',
            './js/frontend/ide/editor/editors/image/text/TextLarge',
            './js/frontend/ide/editor/editors/image/text/TextMedium',
            './js/frontend/ide/editor/editors/image/text/TextSmall',
            './js/frontend/ide/editor/editors/image/toolbar/ToolbarTop',
            './js/frontend/ide/editor/editors/image/toolbar/ToolbarBottom',
            './js/frontend/ide/editor/editors/image/Image',
            './js/frontend/ide/editor/editors/image/Grid',
            './js/frontend/ide/editor/editors/image/selection/Selection',
            './js/frontend/ide/editor/editors/image/selection/SelectionCopy',
            './js/frontend/ide/editor/editors/image/selection/SelectionText',
            './js/frontend/ide/editor/editors/image/ImageLoader',
            './js/frontend/ide/editor/editors/image/ImageEditorState',
            './js/frontend/ide/editor/editors/image/ImageEditor',
            './js/frontend/ide/editor/editors/sound/toolbar/ToolbarTop',
            './js/frontend/ide/editor/editors/sound/toolbar/ToolbarBottom',
            './js/frontend/ide/editor/editors/sound/SoundLoader',
            './js/frontend/ide/editor/editors/sound/Sound',
            './js/frontend/ide/editor/editors/sound/SoundEditorState',
            './js/frontend/ide/editor/editors/sound/SoundEditor',
            './js/frontend/ide/editor/Editors',
            './js/frontend/ide/editor/EditorsState',
            './js/frontend/ide/editor/Editor',
            './js/frontend/ide/console/spans',
            './js/frontend/ide/console/components/VarView',
            './js/frontend/ide/console/components/VarViewNumber',
            './js/frontend/ide/console/components/VarViewString',
            './js/frontend/ide/console/components/VarViewRecord',
            './js/frontend/ide/console/tree/ArrayTreeBuilder',
            './js/frontend/ide/console/tree/RecordTreeBuilder',
            './js/frontend/ide/console/Vars',
            './js/frontend/ide/console/Registers',
            './js/frontend/ide/console/Log',
            './js/frontend/ide/console/Console',
            './js/frontend/ide/simulator/io/text/Text',
            './js/frontend/ide/simulator/io/text/TextLarge',
            './js/frontend/ide/simulator/io/text/TextMedium',
            './js/frontend/ide/simulator/io/text/TextSmall',
            './js/frontend/ide/simulator/io/Light',
            './js/frontend/ide/simulator/io/Button',
            './js/frontend/ide/simulator/io/Buttons',
            './js/frontend/ide/simulator/io/Display',
            './js/frontend/ide/simulator/io/Sound',
            './js/frontend/ide/simulator/io/MotorState',
            './js/frontend/ide/simulator/io/Motor',
            './js/frontend/ide/simulator/io/Sensor',
            './js/frontend/ide/simulator/SimulatorToolbar',
            './js/frontend/ide/simulator/SimulatorModules',
            './js/frontend/ide/simulator/SimulatorMotors',
            './js/frontend/ide/simulator/SimulatorSensors',
            './js/frontend/ide/simulator/Simulator',
            './js/frontend/ide/CompileAndRun',
            './js/frontend/ide/IDE',
            './js/frontend/ide/settings/SettingsState',
            './js/frontend/lib/UIState',
            './js/frontend/vm/brick/BrickState'
        ];

    function onLoaded(loadedFiles) {
        let settings;
        let ui;
        const onLoadedSettings = function() {
            const IDE        = loadedFiles['./js/frontend/ide/IDE'].IDE;
            const BrickState = loadedFiles['./js/frontend/vm/brick/BrickState'].BrickState;
            new IDE({
                ui:       ui,
                settings: settings,
                brick:    new BrickState({layerCount: settings.getDaisyChainMode()})
            });
        };
        const getDataProvider = loadedFiles['./js/frontend/lib/dataprovider/dataProvider'].getDataProvider;
        const UIState         = loadedFiles['./js/frontend/lib/UIState'].UIState;
        const SettingsState   = loadedFiles['./js/frontend/ide/settings/SettingsState'].SettingsState;
        ui       = new UIState();
        settings = new SettingsState({getDataProvider: getDataProvider});
        settings.load(onLoadedSettings);
    }

    window.addEventListener(
        'DOMContentLoaded',
        function() {
            document.querySelector('.progress').style.display = 'block';
            load(files, onLoaded);
        }
    );
})();
